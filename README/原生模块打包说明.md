# 原生模块打包说明

## 问题说明

`pkg` 工具对原生模块（如 `sqlite3`、`better-sqlite3`）的支持有限。这些模块包含 C++ 编译的二进制文件，pkg 可能无法自动检测和包含它们。

## 当前解决方案

程序已配置为在打包环境中使用 `sqlite3`，但 pkg 可能仍然无法正确打包其原生二进制文件。

## 替代方案

### 方案 1: 使用外部 node_modules（推荐）

如果 pkg 无法正确打包 sqlite3，可以将 `node_modules` 目录放在可执行文件同目录下：

1. 打包后，将 `queueSystem-server/node_modules` 复制到 `dist/` 目录
2. 确保 `node_modules/sqlite3` 目录存在
3. 程序会在运行时自动查找并使用

### 方案 2: 使用其他打包工具

考虑使用以下替代打包工具：
- **nexe** - 对原生模块支持更好
- **electron-builder** - 如果考虑使用 Electron
- **Docker** - 容器化部署

### 方案 3: 手动包含二进制文件

1. 找到 sqlite3 的二进制文件位置：
   ```
   queueSystem-server/node_modules/sqlite3/lib/binding/
   ```
2. 将对应平台的二进制文件复制到可执行文件同目录
3. 修改代码以从外部路径加载

## 临时解决方案

如果急需使用，可以：

1. **不打包，直接运行 Node.js 代码**：
   ```bash
   cd queueSystem-server
   npm start
   ```

2. **使用 PM2 管理进程**（生产环境推荐）：
   ```bash
   npm install -g pm2
   cd queueSystem-server
   pm2 start index.js --name queue-system
   ```

## 建议

对于生产环境，建议：
1. 使用 PM2 或 Windows Service 管理 Node.js 进程
2. 不打包成可执行文件，直接运行 Node.js 代码
3. 或考虑使用 Docker 容器化部署

这样可以避免原生模块打包的复杂性，同时获得更好的稳定性和可维护性。

